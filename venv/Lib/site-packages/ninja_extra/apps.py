<<<<<<< HEAD
<<<<<<< HEAD
from typing import Any, cast
=======
import typing as t
>>>>>>> ecbd90b (Initial commit)
=======
from typing import Any, cast
>>>>>>> 903c694 (inital commit)

from django.apps import AppConfig, apps
from django.utils.translation import gettext_lazy as _
from injector import Injector, Module

<<<<<<< HEAD
<<<<<<< HEAD
from ninja_extra.conf import settings
=======
from ninja_extra.lazy import settings_lazy
>>>>>>> ecbd90b (Initial commit)
=======
from ninja_extra.conf import settings
>>>>>>> 903c694 (inital commit)
from ninja_extra.modules import NinjaExtraModule
from ninja_extra.shortcuts import fail_silently


class NinjaExtraConfig(AppConfig):
    default_auto_field = "django.db.models.BigAutoField"
    name = "ninja_extra"
    verbose_name = _("Django Ninja Extra")
    injector: Injector
    ninja_extra_module = None

    def ready(self) -> None:
        self.ninja_extra_module = NinjaExtraModule()
        self.injector = Injector([self.ninja_extra_module])
        # get django_injector is available or registered
        django_injector_app = fail_silently(
            apps.get_app_config, app_label="django_injector"
        )
<<<<<<< HEAD
<<<<<<< HEAD
        app = cast(Any, django_injector_app)
        if app:  # pragma: no cover
            app.ready()
            self.injector = app.injector
        self.register_injector_modules()

    def register_injector_modules(self) -> None:  # pragma: no cover
        for module in settings.INJECTOR_MODULES:
=======
        app = t.cast(t.Any, django_injector_app)
=======
        app = cast(Any, django_injector_app)
>>>>>>> 903c694 (inital commit)
        if app:  # pragma: no cover
            app.ready()
            self.injector = app.injector
        self.register_injector_modules()

    def register_injector_modules(self) -> None:  # pragma: no cover
<<<<<<< HEAD
        for module in settings_lazy().INJECTOR_MODULES:
>>>>>>> ecbd90b (Initial commit)
=======
        for module in settings.INJECTOR_MODULES:
>>>>>>> 903c694 (inital commit)
            if isinstance(module, type) and issubclass(module, Module):
                module = module()
            self.injector.binder.install(module)
